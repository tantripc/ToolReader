@using ObjectDefine
@{
    string _currentCulture = System.Globalization.CultureInfo.CurrentCulture.Name;
    Layout = null;
}
<div id="addsh" role="application">
    <div style="width:100%;display: flex;justify-content: space-between;padding-right: 5px;">
        <div style="width: calc(50% - 40px);position:relative;margin-bottom:10px;">
            <input type='text' style="width:100%;" id='searchBox' class='k-textbox' placeholder='@Localizer["nhapnoidungtimkiem"]' />
            <i class="iconmoon iconmoon-TimKiem" id="search_icon" style="position: absolute;right: 8px;top: 8px;cursor: pointer;"></i>
        </div>
        <div style="width: calc(54% - 40px);position:relative;margin-bottom:10px;">
            <input type='text' style="width:100%;" id='searchBoxselect' class='k-textbox' placeholder='@Localizer["nhapnoidungtimkiem"]' />
            <i class="iconmoon iconmoon-TimKiem" id="search_iconselect" style="position: absolute;right: 8px;top: 8px;cursor: pointer;"></i>
        </div>
    </div>
    <div class="course-section k-content wide">
        <label for="optional">@Localizer["nguoidung"]</label>
        <label for="selected">@Localizer["nguoidungdachon"]</label>
        <br />
        <select id="optional"></select>
        <select id="selected"></select>
    </div>
    <script>
        var link_api_file = '@(WebConfigs.AppSettings.WebApiFileUrl.TrimEnd('/')+"/")';
        $(document).ready(function () {
            var ugid = '@ViewBag.ugid';
            var learnerTemplate = '<span class="k-state-default" style="background-image: url(\'' + link_api_file + '#if(data.profilephoto!=null){##:data.profilephoto##}else{#Avatar/NoAvatar.png#}#\')"></span>' +
                '<span class="k-state-default"><h3 id="username_usermember">#if(data.fullname!=null){##:data.fullname##}else{##:data.emailaddr##}#\</h3><h3 id="ugid" class="d-none">#: data.ugid #</h3><p id="emailaddr_usermember">#if(data.username!=null){##:data.username##}else{##}#\</p></span>';
            $("#optional").kendoListBox({
                dataTextField: "username",
                dataValueField: "userid",
                template: learnerTemplate,
                dataSource: {
                    transport: {
                        read: function (options) {
                            $.ajax({
                                url: _RootBase + "Account/useraddgroup_search",
                                type: "Get",
                                dataType: "json",
                                async: false,
                                data: {
                                    posstart: 1,
                                    numofrow: -1,
                                    ugid: ugid
                                },
                                success: function (result) {
                                    var data = result.data;
                                    options.success(data);
                                },
                                error: function (result) {
                                    options.error(result);
                                }
                            });
                        }
                    },
                },
                draggable: { placeholder: customPlaceholder },
                dropSources: ["selected"],
                connectWith: "selected",
                toolbar: {
                    position: "right",
                    tools: ["transferTo", "transferFrom"]
                },
                selectable: "multiple",
            });

            $("#selected").kendoListBox({
                dataTextField: "username",
                dataValueField: "userid",
                template: learnerTemplate,
                draggable: { placeholder: customPlaceholder },
                dropSources: ["optional"],
                connectWith: "optional"
            });

            function customPlaceholder(draggedItem) {
                return draggedItem
                        .clone()
                        .addClass("custom-placeholder")
                        .removeClass("k-ghost");
            }
            $("#searchBox").on("input", function (e) {
                var listBox = $("#optional").getKendoListBox();
                var searchString = $(this).val();
                listBox.dataSource.filter({ field: "username", operator: "contains", value: searchString });
            });
            $('#search_icon').on('click', function () {
                var listBox = $("#optional").getKendoListBox();
                var searchString = $('#searchBox').val();
                listBox.dataSource.filter({ field: "username", operator: "contains", value: searchString });
            });
            $("#searchBoxselect").on("input", function (e) {
                var listBox = $("#selected").getKendoListBox();
                var searchString = $(this).val();
                listBox.dataSource.filter({ field: "username", operator: "contains", value: searchString });
            });
            $('#search_iconselect').on('click', function () {
                var listBox = $("#selected").getKendoListBox();
                var searchString = $('#searchBox').val();
                listBox.dataSource.filter({ field: "username", operator: "contains", value: searchString });
            })
        });
    </script>
</div>
<style>
    #addsh .course-section {
        width: 100%;
    }

    .course-section label {
        margin-bottom: 5px;
        font-weight: bold;
        display: inline-block;
        width: calc(50% - 5px);
    }

    #addsh .k-listbox {
        width: calc(50% - 5px);
        height: 310px;
    }

        #addsh .k-listbox:first-child {
            width: 50%;
            margin-right: 1px;
        }

    .k-ghost {
        display: none !important;
    }

    .custom-placeholder {
        opacity: 0.4;
    }

    #addsh .k-item {
        line-height: 1em;
    }

    /* Material Theme padding adjustment*/

    .k-material #addsh .k-item,
    .k-material #addsh .k-item.k-state-hover,
    .k-materialblack #addsh .k-item,
    .k-materialblack #examplel .k-item.k-state-hover {
        padding-left: 5px;
        border-left: 0;
    }

    .k-item > span {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        display: inline-block;
        vertical-align: top;
        margin: 20px 10px 10px 5px;
    }

    #addsh .k-item > span {
        width: calc(100% - 85px);
    }

        #addsh .k-item > span:first-child,
        .k-item.k-drag-clue > span:first-child {
            -moz-box-shadow: inset 0 0 30px rgba(0,0,0,.3);
            -webkit-box-shadow: inset 0 0 30px rgba(0,0,0,.3);
            box-shadow: inset 0 0 30px rgba(0,0,0,.3);
            margin: 10px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
        }

    #addsh h3,
    .k-item.k-drag-clue h3 {
        font-size: 1.2em;
        font-weight: normal;
        margin: 0 0 1px 0;
        padding: 0;
    }

    #addsh p {
        margin: 0;
        padding: 0;
        font-size: .8em;
    }
</style>


